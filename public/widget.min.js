(function(){"use strict";var BUTTON_SIZE=100,OPEN_WIDTH=500,OPEN_HEIGHT=650;function createWidget(c){if(document.getElementById("ai-agent-widget-root")){console.warn("AI Agent Widget is already loaded");return}var r=document.createElement("div");r.id="ai-agent-widget-root";document.body.appendChild(r);var f=document.createElement("iframe");f.id="ai-agent-widget-iframe";f.src=c.widgetUrl+"/widget?webhookUrl="+encodeURIComponent(c.webhookUrl||"");f.allow="clipboard-write";function setClosed(){f.style.cssText="position:fixed;bottom:0;right:0;width:"+BUTTON_SIZE+"px;height:"+BUTTON_SIZE+"px;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:hidden"}function setOpen(){var m=window.innerWidth<=480;if(m){f.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:visible"}else{f.style.cssText="position:fixed;bottom:0;right:0;width:"+OPEN_WIDTH+"px;height:"+OPEN_HEIGHT+"px;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:visible"}}setClosed();window.addEventListener("message",function(e){if(c.widgetUrl){try{var h=new URL(c.widgetUrl).host;if(!e.origin.includes(h))return}catch(x){return}}if(e.data.type==="widget-open")setOpen();else if(e.data.type==="widget-close")setClosed()});r.appendChild(f)}function init(){var s=document.currentScript||document.querySelector('script[src*="widget"]')||document.querySelector("script[data-widget-url]");var w=s?.getAttribute("data-widget-url");if(!w&&s?.src){try{w=new URL(s.src).origin}catch(e){}}if(!w){console.error("AI Agent Widget: Could not determine widget URL");return}var c={webhookUrl:s?.getAttribute("data-webhook-url")||null,widgetUrl:w};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",function(){createWidget(c)})}else{createWidget(c)}}init()})();

