(function(){'use strict';const d={webhookUrl:null,position:'bottom-right',primaryColor:'#6b8068',widgetUrl:null},CW=340,CH=220,W=500,H=650;function c(e){if(document.getElementById('ai-agent-widget-root')){console.warn('AI Agent Widget is already loaded');return}const r=document.createElement('div');r.id='ai-agent-widget-root';document.body.appendChild(r);const i=document.createElement('iframe');i.id='ai-agent-widget-iframe';i.src=`${e.widgetUrl}/widget?webhookUrl=${encodeURIComponent(e.webhookUrl||'')}`;i.allow='clipboard-write';const s=()=>{i.style.cssText=`position:fixed;bottom:0;right:0;width:${CW}px;height:${CH}px;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:visible;`},o=()=>{const m=window.innerWidth<=480;if(m){i.style.cssText=`position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:visible;`}else{i.style.cssText=`position:fixed;bottom:0;right:0;width:${W}px;height:${H}px;border:none;z-index:999999;background:transparent;pointer-events:auto;overflow:visible;`}};s();window.addEventListener('message',function(t){if(e.widgetUrl){try{const u=new URL(e.widgetUrl).host;if(!t.origin.includes(u))return}catch(x){return}}if(t.data.type==='widget-open'){o()}else if(t.data.type==='widget-close'){s()}});r.appendChild(i)}function init(){const s=document.currentScript||document.querySelector('script[src*="widget"]')||document.querySelector('script[data-widget-url]');let w=s?.getAttribute('data-widget-url');if(!w&&s?.src){try{const u=new URL(s.src);w=u.origin}catch(e){console.error('Failed to parse widget URL')}}if(!w){console.error('AI Agent Widget: Could not determine widget URL');return}const cfg={...d,webhookUrl:s?.getAttribute('data-webhook-url')||null,widgetUrl:w};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>c(cfg))}else{c(cfg)}}init()})();
